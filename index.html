<html>
<head>
<title>BioParticles</title>
<script src="pixi.js"></script>
<script src="bioparticles.js"></script>
</head>
<body>
	
<script type="text/javascript">
	function getRandSymbol(){
		var res = Math.random();
		if(res > 0.5) return 1;
		if(res <= 0.5) return -1;
	}

	var canvas_size_x = 1200;
	var canvas_size_y = 800;
	var particle_id_counter = 0;

	var app = new PIXI.Application(canvas_size_x, canvas_size_y, { antialias: true, backgroundColor : 0xffffff});
	document.body.appendChild(app.view);

	var graphics = new PIXI.Graphics();
	app.stage.addChild(graphics);
	//initialize particles
	var particles = [];

	// var p = new Particle();
	// p.size = 10;
	// p.mass = p.size;
	// p.color = 0x0000ff;
	// p.x = 100;
	// p.y = 100;
	// p.vel = [0,10];
	// p.name = "Electron";
	// p.interactions = [{name:"repel", interacts_with: "Electron", direction: 1, range: 10*p.size, force:10},
	// 				  {name:"attract", interacts_with: "Proton", direction: -1, range: 10* p.size, force:10}];
	// particles.push(p);

	// var p = new Particle();
	// p.size = 10;
	// p.mass = p.size;
	// p.color = 0x0000ff;
	// p.x = 400;
	// p.y = 100;
	// p.vel = [0,10];
	// p.name = "Electron";
	// p.interactions = [{name:"repel", interacts_with: "Electron", direction: 1, range: 10*p.size, force:10},
	// 				  {name:"attract", interacts_with: "Proton", direction: -1, range: 10* p.size, force:10}];
	// particles.push(p);

	// var p = new Particle();
	// p.size = 10;
	// p.mass = p.size;
	// p.color = 0x0000ff;
	// p.x = 400;
	// p.y = 200;
	// p.vel = [0,10];
	// p.name = "Electron";
	// p.interactions = [{name:"repel", interacts_with: "Electron", direction: 1, range: 10*p.size, force:10},
	// 				  {name:"attract", interacts_with: "Proton", direction: -1, range: 10* p.size, force:10}];
	// particles.push(p);

	// p = new Particle();
	// p.size = 13;
	// p.mass = p.size;
	// p.color = 0xff0000;
	// p.x = 300;
	// p.y = 100;
	// p.vel = [0,0];
	// p.name = "Proton";
	// p.interactions = [{name:"repel", interacts_with: "Proton", direction: 1, range: 10*p.size, force:10},
	// 				  {name:"attract", interacts_with: "Electron", direction: -1, range: 10* p.size, force:10}];
	// particles.push(p);


	for (var i = 0; i <120; i++)
	{
		var p = new Particle();
		p.size = (Math.random() * 3) + 2.5;
		//p.size = 3;
		p.mass = p.size;
		p.color = 0x0000ff;
		p.x = Math.floor((Math.random() * canvas_size_x - p.size) + p.size);
		p.y = Math.floor((Math.random() * canvas_size_y - p.size) + p.size);
		p.vel = [Math.floor((Math.random() * 8) + 1)*getRandSymbol(), Math.floor((Math.random() * 8) + 1)*getRandSymbol()];
		p.name = "A";
		p.interactions = [{name:"repel", interacts_with: "A", direction: 1, range: 10*p.size, force:10},
						  {name:"repel", interacts_with: "C", direction: 1, range: 10*p.size, force:10},
						  {name:"attract", interacts_with: "B", direction: -1, range: 10* p.size, force:10},
						  {name:"attract", interacts_with: "D", direction: -1, range: 10* p.size, force:10},];
		particles.push(p);
	}

	for (var i = 0; i <120; i++)
	{
		var p = new Particle();
		p.size = (Math.random() * 3) + 2.5;
		//p.size = 3;
		p.mass = p.size;
		p.color = 0xff00ff;
		p.x = Math.floor((Math.random() * canvas_size_x - p.size) + p.size);
		p.y = Math.floor((Math.random() * canvas_size_y - p.size) + p.size);
		p.vel = [Math.floor((Math.random() * 8) + 1)*getRandSymbol(), Math.floor((Math.random() * 8) + 1)*getRandSymbol()];
		p.name = "B";
		p.interactions = [{name:"repel", interacts_with: "B", direction: 1, range: 10*p.size, force:10},
						  {name:"repel", interacts_with: "D", direction: 1, range: 10*p.size, force:10},
						  {name:"attract", interacts_with: "C", direction: -1, range: 10* p.size, force:10},
						  {name:"attract", interacts_with: "A", direction: -1, range: 10* p.size, force:10}];
		particles.push(p);
	}

	for (var i = 0; i < 120; i++)
	{
		var p = new Particle();
		p.size = (Math.random() * 3) + 2.5;
		//p.size = 3;
		p.mass = p.size;
		p.color = 0xff0000;
		p.x = Math.floor((Math.random() * canvas_size_x - p.size) + p.size);
		p.y = Math.floor((Math.random() * canvas_size_y - p.size) + p.size);
		p.vel = [Math.floor((Math.random() * 8) + 1)*getRandSymbol(), Math.floor((Math.random() * 8) + 1)*getRandSymbol()];
		p.name = "C";
		p.interactions = [{name:"repel", interacts_with: "C", direction: 1, range: 10* p.size, force:10},
						  {name:"repel", interacts_with: "A", direction: 1, range: 10* p.size, force:10},
						  {name:"attract", interacts_with: "D", direction: -1, range: 10*p.size, force:10},
						  {name:"attract", interacts_with: "B", direction: -1, range: 10*p.size, force:10}];
		particles.push(p);
	}
	for (var i = 0; i < 120; i++)
	{
		var p = new Particle();
		p.size = (Math.random() * 3) + 2.5;
		//p.size = 3;
		p.mass = p.size;
		p.color = 0xff7f00;
		p.x = Math.floor((Math.random() * canvas_size_x - p.size) + p.size);
		p.y = Math.floor((Math.random() * canvas_size_y - p.size) + p.size);
		p.vel = [Math.floor((Math.random() * 8) + 1)*getRandSymbol(), Math.floor((Math.random() * 8) + 1)*getRandSymbol()];
		p.name = "D";
		p.interactions = [{name:"repel", interacts_with: "D", direction: 1, range: 10* p.size, force:10},
						  {name:"repel", interacts_with: "B", direction: 1, range: 10* p.size, force:10},
						  {name:"attract", interacts_with: "A", direction: -1, range: 10*p.size, force:10},
						  {name:"attract", interacts_with: "C", direction: -1, range: 10*p.size, force:10}];
		particles.push(p);
	}

	for (var i = 0; i < 20; i++)
	{
		var p = new Particle();
		p.size = 3;
		p.mass = p.size;
		p.color = 0x000000;
		p.elasticity = 1;
		p.friction = 0.0001;
		p.x = Math.floor((Math.random() * canvas_size_x - p.size) + p.size);
		p.y = Math.floor((Math.random() * canvas_size_y - p.size) + p.size);
		p.vel = [10,10];
		p.name = "Bullet";
		//just bounce against everything
		p.interactions = [{name:"repel", interacts_with: "A", direction: 1, range: p.size-1, force:10},
						  {name:"repel", interacts_with: "B", direction: 1, range: p.size-1, force:10},
						  {name:"repel", interacts_with: "C", direction: 1, range: p.size-1, force:10},
						  {name:"repel", interacts_with: "D", direction: 1, range: p.size-1, force:10},
						  {name:"repel", interacts_with: "Bullet", direction: 1, range: p.size-1, force:10}];
		particles.push(p);
	}

	// for (var i = 0; i < 10; i++)
	// {
	// 	var p = new Particle();
	// 	p.size = (Math.random() * 3) + 2;
	// 	p.mass = p.size;
	// 	p.color = 0x00ff00;
	// 	p.elasticity = 0.1;
	// 	p.friction = 0.0001;
	// 	p.x = Math.floor((Math.random() * canvas_size_x - p.size) + p.size);
	// 	p.y = Math.floor((Math.random() * canvas_size_y - p.size) + p.size);
	// 	p.vel = [Math.floor((Math.random() * 8) + 1)*getRandSymbol(), Math.floor((Math.random() * 8) + 1)*getRandSymbol()];
	// 	p.name = "Sticky";
	// 	//just attatch to everything
	// 	p.interactions = [{name:"attract", interacts_with: "A", direction: -1, range: p.size+1, force:10},
	// 					  {name:"attract", interacts_with: "B", direction: -1, range: p.size+1, force:10},
	// 					  {name:"attract", interacts_with: "C", direction: -1, range: p.size+1, force:10},
	// 					  {name:"attract", interacts_with: "Bullet", direction: -1, range: p.size+1, force:10},
	// 					  {name:"attract", interacts_with: "Sticky", direction: -1, range: p.size+1, force:10}];
	// 	particles.push(p);
	// }
	// Listen for animate update
	var frame_counter = 0;
	app.ticker.add(function(delta) {

		if(frame_counter % 1 == 0){
			graphics.clear();
			for (var i = 0; i < particles.length; i++)
			{
				particles[i].drawCircl(graphics);
			}
		}
		
		for (var i = 0; i < particles.length; i++)
		{
			particles[i].move(canvas_size_x, canvas_size_y);
			particles[i].processCollisions(particles);
		}
		frame_counter +=1;
	});
</script>
</body>
</html>